function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.apply(this,arguments)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let n={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function r(e){n=e}const i=/[&<>"']/,s=new RegExp(i.source,"g"),o=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(o.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=e=>l[e];function h(e,t){if(t){if(i.test(e))return e.replace(s,c)}else if(o.test(e))return e.replace(a,c);return e}const u=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function g(e){return e.replace(u,(e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}const d=/(^|[^\[])\^/g;function p(e,t){let n="string"==typeof e?e:e.source;t=t||"";const r={replace:(e,t)=>{let i="string"==typeof t?t:t.source;return i=i.replace(d,"$1"),n=n.replace(e,i),r},getRegex:()=>new RegExp(n,t)};return r}function f(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch(e){return null}return e}const m={exec:()=>null};function w(e,t){const n=e.replace(/\|/g,(e,t,n)=>{let r=!1,i=t;for(;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"}).split(/ \|/);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function b(e,t,n){const r=e.length;if(0===r)return"";let i=0;for(;i<r;){const s=e.charAt(r-i-1);if(s!==t||n){if(s===t||!n)break;i++}else i++}return e.slice(0,r-i)}function x(e,t,n,r){const i=t.href,s=t.title?h(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;const e={type:"link",raw:n,href:i,title:s,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,e}return{type:"image",raw:n,href:i,title:s,text:h(o)}}class k{options;rules;lexer;constructor(e){this.options=e||n}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:b(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t){const n=e.match(/^(\s+)(?:```)/);if(null===n)return t;const r=n[1];return t.split("\n").map(e=>{const t=e.match(/^\s+/);if(null===t)return e;const[n]=t;return n.length>=r.length?e.slice(r.length):e}).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=b(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const e=b(t[0].replace(/^ *>[ \t]?/gm,""),"\n"),n=this.lexer.state.top;this.lexer.state.top=!0;const r=this.lexer.blockTokens(e);return this.lexer.state.top=n,{type:"blockquote",raw:t[0],tokens:r,text:e}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,i={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const s=new RegExp(`^( {0,3}${n})((?:[\t ][^\\n]*)?(?:\\n|$))`);let o="",a="",l=!1;for(;e;){let n=!1;if(!(t=s.exec(e)))break;if(this.rules.block.hr.test(e))break;o=t[0],e=e.substring(o.length);let r=t[2].split("\n",1)[0].replace(/^\t+/,e=>" ".repeat(3*e.length)),c=e.split("\n",1)[0],h=0;this.options.pedantic?(h=2,a=r.trimStart()):(h=t[2].search(/[^ ]/),h=h>4?1:h,a=r.slice(h),h+=t[1].length);let u=!1;if(!r&&/^ *$/.test(c)&&(o+=c+"\n",e=e.substring(c.length+1),n=!0),!n){const t=new RegExp(`^ {0,${Math.min(3,h-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),n=new RegExp(`^ {0,${Math.min(3,h-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),i=new RegExp(`^ {0,${Math.min(3,h-1)}}(?:\`\`\`|~~~)`),s=new RegExp(`^ {0,${Math.min(3,h-1)}}#`);for(;e;){const l=e.split("\n",1)[0];if(c=l,this.options.pedantic&&(c=c.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),i.test(c))break;if(s.test(c))break;if(t.test(c))break;if(n.test(e))break;if(c.search(/[^ ]/)>=h||!c.trim())a+="\n"+c.slice(h);else{if(u)break;if(r.search(/[^ ]/)>=4)break;if(i.test(r))break;if(s.test(r))break;if(n.test(r))break;a+="\n"+c}u||c.trim()||(u=!0),o+=l+"\n",e=e.substring(l.length+1),r=c.slice(h)}}i.loose||(l?i.loose=!0:/\n *\n *$/.test(o)&&(l=!0));let g,d=null;this.options.gfm&&(d=/^\[[ xX]\] /.exec(a),d&&(g="[ ] "!==d[0],a=a.replace(/^\[[ xX]\] +/,""))),i.items.push({type:"list_item",raw:o,task:!!d,checked:g,loose:!1,text:a,tokens:[]}),i.raw+=o}i.items[i.items.length-1].raw=o.trimEnd(),i.items[i.items.length-1].text=a.trimEnd(),i.raw=i.raw.trimEnd();for(let e=0;e<i.items.length;e++)if(this.lexer.state.top=!1,i.items[e].tokens=this.lexer.blockTokens(i.items[e].text,[]),!i.loose){const t=i.items[e].tokens.filter(e=>"space"===e.type),n=t.length>0&&t.some(e=>/\n.*\n/.test(e.raw));i.loose=n}if(i.loose)for(let e=0;e<i.items.length;e++)i.items[e].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(/\s+/g," "),n=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!/[:|]/.test(t[2]))return;const n=w(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),i=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const e of r)/^ *-+: *$/.test(e)?s.align.push("right"):/^ *:-+: *$/.test(e)?s.align.push("center"):/^ *:-+ *$/.test(e)?s.align.push("left"):s.align.push(null);for(const e of n)s.header.push({text:e,tokens:this.lexer.inline(e)});for(const e of i)s.rows.push(w(e,s.header.length).map(e=>({text:e,tokens:this.lexer.inline(e)})));return s}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:h(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=b(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let r=0;r<e.length;r++)if("\\"===e[r])r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(e)?n.slice(1):n.slice(1,-1)),x(t,{href:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n,title:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const e=t[(n[2]||n[1]).replace(/\s+/g," ").toLowerCase()];if(!e){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return x(n,e,n[0],this.lexer)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(r&&(!r[3]||!n.match(/[\p{L}\p{N}]/u))&&(!r[1]&&!r[2]||!n||this.rules.inline.punctuation.exec(n))){const n=[...r[0]].length-1;let i,s,o=n,a=0;const l="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+n);null!=(r=l.exec(t));){if(i=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!i)continue;if(s=[...i].length,r[3]||r[4]){o+=s;continue}if((r[5]||r[6])&&n%3&&!((n+s)%3)){a+=s;continue}if(o-=s,o>0)continue;s=Math.min(s,s+o+a);const t=[...r[0]][0].length,l=e.slice(0,n+r.index+t+s);if(Math.min(n,s)%2){const e=l.slice(1,-1);return{type:"em",raw:l,text:e,tokens:this.lexer.inlineTokens(e)}}const c=l.slice(2,-2);return{type:"strong",raw:l,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const n=/[^ ]/.test(e),r=/^ /.test(e)&&/ $/.test(e);return n&&r&&(e=e.substring(1,e.length-1)),e=h(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=h(t[1]),n="mailto:"+e):(e=h(t[1]),n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=h(t[0]),n="mailto:"+e;else{let r;do{r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(r!==t[0]);e=h(t[0]),n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let e;return e=this.lexer.state.inRawBlock?t[0]:h(t[0]),{type:"text",raw:t[0],text:e}}}}const y=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,v=/(?:[*+-]|\d{1,9}[.)])/,_=p(/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,v).getRegex(),$=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,R=/(?!\s*\])(?:\\.|[^\[\]\\])+/,T=p(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",R).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),z=p(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,v).getRegex(),C="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",A=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,E=p("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",A).replace("tag",C).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),S=p($).replace("hr",y).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",C).getRegex(),L={blockquote:p(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",S).getRegex(),code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,def:T,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:y,html:E,lheading:_,list:z,newline:/^(?: *(?:\n|$))+/,paragraph:S,table:m,text:/^[^\n]+/},P=p("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",y).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",C).getRegex(),I={...L,table:P,paragraph:p($).replace("hr",y).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",P).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",C).getRegex()},O={...L,html:p("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",A).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:m,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:p($).replace("hr",y).replace("heading"," *#{1,6} *[^\n]").replace("lheading",_).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},M=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,q=/^( {2,}|\\)\n(?!\s*$)/,D="\\p{P}\\p{S}",B=p(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,D).getRegex(),Z=p(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,D).getRegex(),j=p("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,D).getRegex(),H=p("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,D).getRegex(),W=p(/\\([punct])/,"gu").replace(/punct/g,D).getRegex(),V=p(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),F=p(A).replace("(?:--\x3e|$)","--\x3e").getRegex(),Q=p("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",F).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),N=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Y=p(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",N).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),U=p(/^!?\[(label)\]\[(ref)\]/).replace("label",N).replace("ref",R).getRegex(),K=p(/^!?\[(ref)\](?:\[\])?/).replace("ref",R).getRegex(),X={_backpedal:m,anyPunctuation:W,autolink:V,blockSkip:/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,br:q,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:m,emStrongLDelim:Z,emStrongRDelimAst:j,emStrongRDelimUnd:H,escape:M,link:Y,nolink:K,punctuation:B,reflink:U,reflinkSearch:p("reflink|nolink(?!\\()","g").replace("reflink",U).replace("nolink",K).getRegex(),tag:Q,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:m},J={...X,link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",N).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",N).getRegex()},G={...X,escape:p(M).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},ee={...G,br:p(q).replace("{2,}","*").getRegex(),text:p(G.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},te={normal:L,gfm:I,pedantic:O},ne={normal:X,gfm:G,breaks:ee,pedantic:J};class re{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||n,this.options.tokenizer=this.options.tokenizer||new k,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:te.normal,inline:ne.normal};this.options.pedantic?(t.block=te.pedantic,t.inline=ne.pedantic):this.options.gfm&&(t.block=te.gfm,t.inline=this.options.breaks?ne.breaks:ne.gfm),this.tokenizer.rules=t}static get rules(){return{block:te,inline:ne}}static lex(e,t){return new re(t).lex(e)}static lexInline(e,t){return new re(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){let n,r,i,s;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(e,t,n)=>t+"    ".repeat(n.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(r=>!!(n=r.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0))))if(n=this.tokenizer.space(e))e=e.substring(n.raw.length),1===n.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(n);else if(n=this.tokenizer.code(e))e=e.substring(n.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?t.push(n):(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(n=this.tokenizer.fences(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.heading(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.hr(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.blockquote(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.list(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.html(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.def(e))e=e.substring(n.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(r.raw+="\n"+n.raw,r.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(n=this.tokenizer.table(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.lheading(e))e=e.substring(n.raw.length),t.push(n);else{if(i=e,this.options.extensions&&this.options.extensions.startBlock){let t=Infinity;const n=e.slice(1);let r;this.options.extensions.startBlock.forEach(e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))}),t<Infinity&&t>=0&&(i=e.substring(0,t+1))}if(this.state.top&&(n=this.tokenizer.paragraph(i)))r=t[t.length-1],s&&"paragraph"===r.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n),s=i.length!==e.length,e=e.substring(n.raw.length);else if(n=this.tokenizer.text(e))e=e.substring(n.raw.length),r=t[t.length-1],r&&"text"===r.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,r,i,s,o,a,l=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(l));)e.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.anyPunctuation.exec(l));)l=l.slice(0,s.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(o||(a=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(r=>!!(n=r.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0))))if(n=this.tokenizer.escape(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.tag(e))e=e.substring(n.raw.length),r=t[t.length-1],r&&"text"===n.type&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);else if(n=this.tokenizer.link(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(n.raw.length),r=t[t.length-1],r&&"text"===n.type&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);else if(n=this.tokenizer.emStrong(e,l,a))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.codespan(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.br(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.del(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.autolink(e))e=e.substring(n.raw.length),t.push(n);else if(this.state.inLink||!(n=this.tokenizer.url(e))){if(i=e,this.options.extensions&&this.options.extensions.startInline){let t=Infinity;const n=e.slice(1);let r;this.options.extensions.startInline.forEach(e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))}),t<Infinity&&t>=0&&(i=e.substring(0,t+1))}if(n=this.tokenizer.inlineText(i))e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(a=n.raw.slice(-1)),o=!0,r=t[t.length-1],r&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}else e=e.substring(n.raw.length),t.push(n);return t}}class ie{options;constructor(e){this.options=e||n}code(e,t,n){const r=(t||"").match(/^\S*/)?.[0];return e=e.replace(/\n$/,"")+"\n",r?'<pre><code class="language-'+h(r)+'">'+(n?e:h(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:h(e,!0))+"</code></pre>\n"}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e,t){return e}heading(e,t,n){return`<h${t}>${e}</h${t}>\n`}hr(){return"<hr>\n"}list(e,t,n){const r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"}listitem(e,t,n){return`<li>${e}</li>\n`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>\n`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return`<tr>\n${e}</tr>\n`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>\n`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){const r=f(e);if(null===r)return n;let i='<a href="'+(e=r)+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>",i}image(e,t,n){const r=f(e);if(null===r)return n;let i=`<img src="${e=r}" alt="${n}"`;return t&&(i+=` title="${t}"`),i+=">",i}text(e){return e}}class se{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class oe{options;renderer;textRenderer;constructor(e){this.options=e||n,this.options.renderer=this.options.renderer||new ie,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new se}static parse(e,t){return new oe(t).parse(e)}static parseInline(e,t){return new oe(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){const e=i,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){n+=t||"";continue}}switch(i.type){case"space":continue;case"hr":n+=this.renderer.hr();continue;case"heading":{const e=i;n+=this.renderer.heading(this.parseInline(e.tokens),e.depth,g(this.parseInline(e.tokens,this.textRenderer)));continue}case"code":n+=this.renderer.code(i.text,i.lang,!!i.escaped);continue;case"table":{const e=i;let t="",r="";for(let t=0;t<e.header.length;t++)r+=this.renderer.tablecell(this.parseInline(e.header[t].tokens),{header:!0,align:e.align[t]});t+=this.renderer.tablerow(r);let s="";for(let t=0;t<e.rows.length;t++){const n=e.rows[t];r="";for(let t=0;t<n.length;t++)r+=this.renderer.tablecell(this.parseInline(n[t].tokens),{header:!1,align:e.align[t]});s+=this.renderer.tablerow(r)}n+=this.renderer.table(t,s);continue}case"blockquote":{const e=this.parse(i.tokens);n+=this.renderer.blockquote(e);continue}case"list":{const e=i,t=e.ordered,r=e.start,s=e.loose;let o="";for(let t=0;t<e.items.length;t++){const n=e.items[t],r=n.checked,i=n.task;let a="";if(n.task){const e=this.renderer.checkbox(!!r);s?n.tokens.length>0&&"paragraph"===n.tokens[0].type?(n.tokens[0].text=e+" "+n.tokens[0].text,n.tokens[0].tokens&&n.tokens[0].tokens.length>0&&"text"===n.tokens[0].tokens[0].type&&(n.tokens[0].tokens[0].text=e+" "+n.tokens[0].tokens[0].text)):n.tokens.unshift({type:"text",text:e+" "}):a+=e+" "}a+=this.parse(n.tokens,s),o+=this.renderer.listitem(a,i,!!r)}n+=this.renderer.list(o,t,r);continue}case"html":n+=this.renderer.html(i.text,i.block);continue;case"paragraph":n+=this.renderer.paragraph(this.parseInline(i.tokens));continue;case"text":{let s=i,o=s.tokens?this.parseInline(s.tokens):s.text;for(;r+1<e.length&&"text"===e[r+1].type;)s=e[++r],o+="\n"+(s.tokens?this.parseInline(s.tokens):s.text);n+=t?this.renderer.paragraph(o):o;continue}default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}parseInline(e,t){t=t||this.renderer;let n="";for(let r=0;r<e.length;r++){const i=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){const e=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){n+=e||"";continue}}switch(i.type){case"escape":case"text":n+=t.text(i.text);break;case"html":n+=t.html(i.text);break;case"link":n+=t.link(i.href,i.title,this.parseInline(i.tokens,t));break;case"image":n+=t.image(i.href,i.title,i.text);break;case"strong":n+=t.strong(this.parseInline(i.tokens,t));break;case"em":n+=t.em(this.parseInline(i.tokens,t));break;case"codespan":n+=t.codespan(i.text);break;case"br":n+=t.br();break;case"del":n+=t.del(this.parseInline(i.tokens,t));break;default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}}class ae{options;constructor(e){this.options=e||n}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}const le=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.#e(re.lex,oe.parse);parseInline=this.#e(re.lexInline,oe.parseInline);Parser=oe;Renderer=ie;TextRenderer=se;Lexer=re;Tokenizer=k;Hooks=ae;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(const r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{const e=r;for(const r of e.header)n=n.concat(this.walkTokens(r.tokens,t));for(const r of e.rows)for(const e of r)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":n=n.concat(this.walkTokens(r.items,t));break;default:{const e=r;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach(r=>{const i=e[r].flat(Infinity);n=n.concat(this.walkTokens(i,t))}):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(e=>{const n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach(e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let r=e.renderer.apply(this,t);return!1===r&&(r=n.apply(this,t)),r}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)}),n.extensions=t),e.renderer){const t=this.defaults.renderer||new ie(this.defaults);for(const n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if("options"===n)continue;const r=e.renderer[n],i=t[n];t[n]=(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new k(this.defaults);for(const n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const r=e.tokenizer[n],i=t[n];t[n]=(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new ae;for(const n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if("options"===n)continue;const r=e.hooks[n],i=t[n];t[n]=ae.passThroughHooks.has(n)?e=>{if(this.defaults.async)return Promise.resolve(r.call(t,e)).then(e=>i.call(t,e));const n=r.call(t,e);return i.call(t,n)}:(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,r=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(r.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return re.lex(e,t??this.defaults)}parser(e,t){return oe.parse(e,t??this.defaults)}#e(e,t){return(n,r)=>{const i={...r},s={...this.defaults,...i};!0===this.defaults.async&&!1===i.async&&(s.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),s.async=!0);const o=this.#t(!!s.silent,!!s.async);if(null==n)return o(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof n)return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(s.hooks&&(s.hooks.options=s),s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(n):n).then(t=>e(t,s)).then(e=>s.hooks?s.hooks.processAllTokens(e):e).then(e=>s.walkTokens?Promise.all(this.walkTokens(e,s.walkTokens)).then(()=>e):e).then(e=>t(e,s)).then(e=>s.hooks?s.hooks.postprocess(e):e).catch(o);try{s.hooks&&(n=s.hooks.preprocess(n));let r=e(n,s);s.hooks&&(r=s.hooks.processAllTokens(r)),s.walkTokens&&this.walkTokens(r,s.walkTokens);let i=t(r,s);return s.hooks&&(i=s.hooks.postprocess(i)),i}catch(e){return o(e)}}}#t(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+h(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};function ce(e,t){return le.parse(e,t)}ce.options=ce.setOptions=function(e){return le.setOptions(e),r(ce.defaults=le.defaults),ce},ce.getDefaults=function(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},ce.defaults=n,ce.use=function(...e){return le.use(...e),r(ce.defaults=le.defaults),ce},ce.walkTokens=function(e,t){return le.walkTokens(e,t)},ce.parseInline=le.parseInline,ce.Parser=oe,ce.parser=oe.parse,ce.Renderer=ie,ce.TextRenderer=se,ce.Lexer=re,ce.lexer=re.lex,ce.Tokenizer=k,ce.Hooks=ae,ce.parse=ce;const he=Math.min,ue=Math.max,ge=Math.round,de=Math.floor,pe=e=>({x:e,y:e}),fe={left:"right",right:"left",bottom:"top",top:"bottom"},me={start:"end",end:"start"};function we(e,t,n){return ue(e,he(t,n))}function be(e,t){return"function"==typeof e?e(t):e}function xe(e){return e.split("-")[0]}function ke(e){return e.split("-")[1]}function ye(e){return"x"===e?"y":"x"}function ve(e){return"y"===e?"height":"width"}function _e(e){return["top","bottom"].includes(xe(e))?"y":"x"}function $e(e){return ye(_e(e))}function Re(e){return e.replace(/start|end/g,e=>me[e])}function Te(e){return e.replace(/left|right|bottom|top/g,e=>fe[e])}function ze(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function Ce(e,t,n){let{reference:r,floating:i}=e;const s=_e(t),o=$e(t),a=ve(o),l=xe(t),c="y"===s,h=r.x+r.width/2-i.width/2,u=r.y+r.height/2-i.height/2,g=r[a]/2-i[a]/2;let d;switch(l){case"top":d={x:h,y:r.y-i.height};break;case"bottom":d={x:h,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:u};break;case"left":d={x:r.x-i.width,y:u};break;default:d={x:r.x,y:r.y}}switch(ke(t)){case"start":d[o]-=g*(n&&c?-1:1);break;case"end":d[o]+=g*(n&&c?-1:1)}return d}async function Ae(e,t){var n;void 0===t&&(t={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:u="floating",altBoundary:g=!1,padding:d=0}=be(t,e),p=function(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(d),f=a[g?"floating"===u?"reference":"floating":u],m=ze(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(f)))||n?f:f.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:h,strategy:l})),w="floating"===u?{...o.floating,x:r,y:i}:o.reference,b=await(null==s.getOffsetParent?void 0:s.getOffsetParent(a.floating)),x=await(null==s.isElement?void 0:s.isElement(b))&&await(null==s.getScale?void 0:s.getScale(b))||{x:1,y:1},k=ze(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:w,offsetParent:b,strategy:l}):w);return{top:(m.top-k.top+p.top)/x.y,bottom:(k.bottom-m.bottom+p.bottom)/x.y,left:(m.left-k.left+p.left)/x.x,right:(k.right-m.right+p.right)/x.x}}function Ee(e){return Pe(e)?(e.nodeName||"").toLowerCase():"#document"}function Se(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Le(e){var t;return null==(t=(Pe(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Pe(e){return e instanceof Node||e instanceof Se(e).Node}function Ie(e){return e instanceof Element||e instanceof Se(e).Element}function Oe(e){return e instanceof HTMLElement||e instanceof Se(e).HTMLElement}function Me(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof Se(e).ShadowRoot)}function qe(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=He(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function De(e){return["table","td","th"].includes(Ee(e))}function Be(e){const t=Ze(),n=He(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some(e=>(n.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(n.contain||"").includes(e))}function Ze(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function je(e){return["html","body","#document"].includes(Ee(e))}function He(e){return Se(e).getComputedStyle(e)}function We(e){return Ie(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ve(e){if("html"===Ee(e))return e;const t=e.assignedSlot||e.parentNode||Me(e)&&e.host||Le(e);return Me(t)?t.host:t}function Fe(e){const t=Ve(e);return je(t)?e.ownerDocument?e.ownerDocument.body:e.body:Oe(t)&&qe(t)?t:Fe(t)}function Qe(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const i=Fe(e),s=i===(null==(r=e.ownerDocument)?void 0:r.body),o=Se(i);return s?t.concat(o,o.visualViewport||[],qe(i)?i:[],o.frameElement&&n?Qe(o.frameElement):[]):t.concat(i,Qe(i,[],n))}function Ne(e){const t=He(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=Oe(e),s=i?e.offsetWidth:n,o=i?e.offsetHeight:r,a=ge(n)!==s||ge(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function Ye(e){return Ie(e)?e:e.contextElement}function Ue(e){const t=Ye(e);if(!Oe(t))return pe(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:s}=Ne(t);let o=(s?ge(n.width):n.width)/r,a=(s?ge(n.height):n.height)/i;return o&&Number.isFinite(o)||(o=1),a&&Number.isFinite(a)||(a=1),{x:o,y:a}}const Ke=/*#__PURE__*/pe(0);function Xe(e){const t=Se(e);return Ze()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Ke}function Je(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const i=e.getBoundingClientRect(),s=Ye(e);let o=pe(1);t&&(r?Ie(r)&&(o=Ue(r)):o=Ue(e));const a=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Se(e))&&t}(s,n,r)?Xe(s):pe(0);let l=(i.left+a.x)/o.x,c=(i.top+a.y)/o.y,h=i.width/o.x,u=i.height/o.y;if(s){const e=Se(s),t=r&&Ie(r)?Se(r):r;let n=e,i=n.frameElement;for(;i&&r&&t!==n;){const e=Ue(i),t=i.getBoundingClientRect(),r=He(i),s=t.left+(i.clientLeft+parseFloat(r.paddingLeft))*e.x,o=t.top+(i.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,c*=e.y,h*=e.x,u*=e.y,l+=s,c+=o,n=Se(i),i=n.frameElement}}return ze({width:h,height:u,x:l,y:c})}const Ge=[":popover-open",":modal"];function et(e){return Ge.some(t=>{try{return e.matches(t)}catch(e){return!1}})}function tt(e){return Je(Le(e)).left+We(e).scrollLeft}function nt(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=Se(e),r=Le(e),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const e=Ze();(!e||e&&"fixed"===t)&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a,y:l}}(e,n);else if("document"===t)r=function(e){const t=Le(e),n=We(e),r=e.ownerDocument.body,i=ue(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=ue(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+tt(e);const a=-n.scrollTop;return"rtl"===He(r).direction&&(o+=ue(t.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}(Le(e));else if(Ie(t))r=function(e,t){const n=Je(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,s=Oe(e)?Ue(e):pe(1);return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:i*s.x,y:r*s.y}}(t,n);else{const n=Xe(e);r={...t,x:t.x-n.x,y:t.y-n.y}}return ze(r)}function rt(e,t){const n=Ve(e);return!(n===t||!Ie(n)||je(n))&&("fixed"===He(n).position||rt(n,t))}function it(e,t,n){const r=Oe(t),i=Le(t),s="fixed"===n,o=Je(e,!0,s,t);let a={scrollLeft:0,scrollTop:0};const l=pe(0);if(r||!r&&!s)if(("body"!==Ee(t)||qe(i))&&(a=We(t)),r){const e=Je(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else i&&(l.x=tt(i));return{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function st(e,t){return Oe(e)&&"fixed"!==He(e).position?t?t(e):e.offsetParent:null}function ot(e,t){const n=Se(e);if(!Oe(e)||et(e))return n;let r=st(e,t);for(;r&&De(r)&&"static"===He(r).position;)r=st(r,t);return r&&("html"===Ee(r)||"body"===Ee(r)&&"static"===He(r).position&&!Be(r))?n:r||function(e){let t=Ve(e);for(;Oe(t)&&!je(t);){if(Be(t))return t;t=Ve(t)}return null}(e)||n}const at={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e;const s="fixed"===i,o=Le(r),a=!!t&&et(t.floating);if(r===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=pe(1);const h=pe(0),u=Oe(r);if((u||!u&&!s)&&(("body"!==Ee(r)||qe(o))&&(l=We(r)),Oe(r))){const e=Je(r);c=Ue(r),h.x=e.x+r.clientLeft,h.y=e.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+h.x,y:n.y*c.y-l.scrollTop*c.y+h.y}},getDocumentElement:Le,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const s=[..."clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let r=Qe(e,[],!1).filter(e=>Ie(e)&&"body"!==Ee(e)),i=null;const s="fixed"===He(e).position;let o=s?Ve(e):e;for(;Ie(o)&&!je(o);){const t=He(o),n=Be(o);n||"fixed"!==t.position||(i=null),(s?!n&&!i:!n&&"static"===t.position&&i&&["absolute","fixed"].includes(i.position)||qe(o)&&!n&&rt(e,o))?r=r.filter(e=>e!==o):i=t,o=Ve(o)}return t.set(e,r),r}(t,this._c):[].concat(n),r],o=s.reduce((e,n)=>{const r=nt(t,n,i);return e.top=ue(r.top,e.top),e.right=he(r.right,e.right),e.bottom=he(r.bottom,e.bottom),e.left=ue(r.left,e.left),e},nt(t,s[0],i));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:ot,getElementRects:async function(e){const t=this.getOffsetParent||ot,n=this.getDimensions;return{reference:it(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,...await n(e.floating)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Ne(e);return{width:t,height:n}},getScale:Ue,isElement:Ie,isRTL:function(e){return"rtl"===He(e).direction}},lt=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:h=!0,crossAxis:u=!0,fallbackPlacements:g,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:f=!0,...m}=be(e,t);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const w=xe(i),b=xe(a)===a,x=await(null==l.isRTL?void 0:l.isRTL(c.floating)),k=g||(b||!f?[Te(a)]:function(e){const t=Te(e);return[Re(e),t,Re(t)]}(a));g||"none"===p||k.push(...function(e,t,n,r){const i=ke(e);let s=function(e,t,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?s:o;default:return[]}}(xe(e),"start"===n,r);return i&&(s=s.map(e=>e+"-"+i),t&&(s=s.concat(s.map(Re)))),s}(a,f,p,x));const y=[a,...k],v=await Ae(t,m),_=[];let $=(null==(r=s.flip)?void 0:r.overflows)||[];if(h&&_.push(v[w]),u){const e=function(e,t,n){void 0===n&&(n=!1);const r=ke(e),i=$e(e),s=ve(i);let o="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=Te(o)),[o,Te(o)]}(i,o,x);_.push(v[e[0]],v[e[1]])}if($=[...$,{placement:i,overflows:_}],!_.every(e=>e<=0)){var R,T;const e=((null==(R=s.flip)?void 0:R.index)||0)+1,t=y[e];if(t)return{data:{index:e,overflows:$},reset:{placement:t}};let n=null==(T=$.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:T.placement;if(!n)switch(d){case"bestFit":{var z;const e=null==(z=$.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:z[0];e&&(n=e);break}case"initialPlacement":n=a}if(i!==n)return{reset:{placement:n}}}return{}}}};var ct;function ht(e,t,n){if(!e.s){if(n instanceof gt){if(!n.s)return void(n.o=ht.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(ht.bind(null,e,t),ht.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var ut=function(t){try{t.preventDefault();var n=t.target;if(!xt.url)return console.error("LangChat Chat Widget: No URL provided"),xt.disableErrorAlert||alert("Could not send chat message: No URL provided"),Promise.resolve();var r=document.getElementById("langchat-chat-widget__submit");r.setAttribute("disabled","");var i=new Headers;i.append("Content-Type","application/json"),i.append("Accept","text/event-stream"),i.append("Authorization","Bearer "+xt.apiKey);var s=n.elements.message.value,o=e({},xt.user,{messages:[{role:"user",content:s}],threadId:xt.threadId,timestamp:Date.now()});return Promise.resolve(pt(s,o.timestamp,"user")).then(function(){function e(){return r.removeAttribute("disabled"),!1}n.reset(),vt.prepend($t);var t=function(e,t){try{var n=Promise.resolve(fetch(xt.url,{method:"POST",headers:i,body:JSON.stringify(o)})).then(function(e){$t.remove();var t=xt.responseIsAStream?Promise.resolve(Ct(e)).then(function(){}):Promise.resolve(zt(e)).then(function(){});if(t&&t.then)return t.then(function(){})})}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}(0,function(e){$t.remove(),console.error("LangChat Chat Widget:",e),xt.disableErrorAlert||alert("Could not send message: "+e.message)});return t&&t.then?t.then(e):e()})}catch(t){return Promise.reject(t)}},gt=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var s=1&i?t:n;if(s){try{ht(r,1,s(this.v))}catch(e){ht(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?ht(r,1,t?t(i):i):n?ht(r,1,n(i)):ht(r,2,i)}catch(e){ht(r,2,e)}},r},e}();function dt(e){return e instanceof gt&&1&e.s}var pt=function(e,t,n){try{var r=document.createElement("div");r.classList.add("langchat-chat-widget__message"),r.classList.add("langchat-chat-widget__message--"+n),r.id="langchat-chat-widget__message--"+n+"--"+t;var i=document.createElement("p");return Promise.resolve(ce(e,{renderer:wt})).then(function(e){i.innerHTML=e,r.appendChild(i);var n=document.createElement("p");n.classList.add("langchat-chat-widget__message-timestamp"),n.textContent=("0"+new Date(t).getHours()).slice(-2)+":"+("0"+new Date(t).getMinutes()).slice(-2),r.appendChild(n),vt.prepend(r)})}catch(e){return Promise.reject(e)}},ft=function(){try{var e=document.createElement("style");return e.innerHTML=":root{--langchat-chat-widget-bg-color:#fff;--langchat-chat-widget-border-color:#e2e2e2;--langchat-chat-widget-shadow:0 0 8rem 0 rgba(0,0,0,.1),0rem 2rem 4rem -3rem rgba(0,0,0,.5);--langchat-chat-widget-primary-color-text:#000;--langchat-chat-widget-secondary-color-text:#979797;--langchat-chat-widget-user-message-text-color:#fff;--langchat-chat-widget-user-message-bg-color:#2c91ed;--langchat-chat-widget-system-message-text-color:#000;--langchat-chat-widget-system-message-bg-color:#e4e4e4;--langchat-chat-widget-primary-color:#2c91ed;--langchat-chat-widget-header-height:4rem;--langchat-chat-widget-button-transition:background-color 0.2s ease-in-out,opacity 0.2s ease-in-out,transform 0.2s ease-in-out;--langchat-chat-widget-title-weight:600;--langchat-chat-widget-button-weight:500;--langchat-chat-widget-border-radius:1rem}@media (prefers-color-scheme:dark){:root{--langchat-chat-widget-bg-color:#2d2d30;--langchat-chat-widget-border-color:#424244;--langchat-chat-widget-shadow:0 0 8rem 0 rgba(0,0,0,.1),0rem 2rem 4rem -3rem rgba(0,0,0,.5);--langchat-chat-widget-primary-color-text:#fff;--langchat-chat-widget-secondary-color-text:#818183;--langchat-chat-widget-user-message-text-color:#fff;--langchat-chat-widget-user-message-bg-color:#2c91ed;--langchat-chat-widget-system-message-text-color:#fff;--langchat-chat-widget-system-message-bg-color:#424244}}[data-theme=light]{--langchat-chat-widget-bg-color:#fff;--langchat-chat-widget-border-color:#e2e2e2;--langchat-chat-widget-shadow:0 0 8rem 0 rgba(0,0,0,.1),0rem 2rem 4rem -3rem rgba(0,0,0,.5);--langchat-chat-widget-primary-color-text:#000;--langchat-chat-widget-secondary-color-text:#979797;--langchat-chat-widget-user-message-text-color:#fff;--langchat-chat-widget-user-message-bg-color:#2c91ed;--langchat-chat-widget-system-message-text-color:#000;--langchat-chat-widget-system-message-bg-color:#e4e4e4}[data-theme=dark]{--langchat-chat-widget-bg-color:#2d2d30;--langchat-chat-widget-border-color:#424244;--langchat-chat-widget-shadow:0 0 8rem 0 rgba(0,0,0,.1),0rem 2rem 4rem -3rem rgba(0,0,0,.5);--langchat-chat-widget-primary-color-text:#fff;--langchat-chat-widget-secondary-color-text:#818183;--langchat-chat-widget-user-message-text-color:#fff;--langchat-chat-widget-user-message-bg-color:#2c91ed;--langchat-chat-widget-system-message-text-color:#fff;--langchat-chat-widget-system-message-bg-color:#424244}#langchat-chat-widget__container{background-color:var(--langchat-chat-widget-bg-color);border-radius:var(--langchat-chat-widget-border-radius);box-shadow:var(--langchat-chat-widget-shadow);box-sizing:border-box;color:var(--langchat-chat-widget-primary-color-text);font-family:inherit;font-size:1rem;height:40rem;opacity:1;overflow:hidden;position:fixed;transform:scale(1);transform-origin:bottom right;transition:transform .3s ease-out,opacity .3s ease-out;width:25rem;z-index:9999}#langchat-chat-widget__container *{box-sizing:border-box}#langchat-chat-widget__container :focus{outline:none}#langchat-chat-widget__backdrop{background-color:transparent;box-sizing:border-box;height:100vh;left:0;position:fixed;top:0;width:100vw;z-index:9998}#langchat-chat-widget__header{align-items:center;display:flex;height:var(--langchat-chat-widget-header-height);justify-content:space-between;padding:1rem}#langchat-chat-widget__title{align-items:center;display:flex;font-weight:var(--langchat-chat-widget-title-weight);width:60%}#langchat-chat-widget__title_icon{margin-right:.5rem}#langchat-chat-widget__title_icon path{fill:var(--langchat-chat-widget-primary-color-text)}#langchat-chat-widget__title_text{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}#langchat-chat-widget__branding{color:var(--langchat-chat-widget-secondary-color-text);font-size:.75rem;text-decoration:none}#langchat-chat-widget__branding>span{color:var(--langchat-chat-widget-primary-color-text)}#langchat-chat-widget__body{box-shadow:inset 0 2rem 2rem -2rem rgba(0,0,0,.05),inset 0 -2rem 2rem -2rem rgba(0,0,0,.05);display:flex;flex-direction:column;height:calc(100% - var(--langchat-chat-widget-header-height));padding:.6rem 1rem 1rem;position:relative;width:100%}#langchat-chat-widget__messages_history{-ms-overflow-style:none;display:flex;flex-direction:column-reverse;flex-grow:1;overflow-y:auto;scrollbar-width:none}#langchat-chat-widget__messages_history::-webkit-scrollbar{display:none}#langchat-chat-widget__messages_history .langchat-chat-widget__message{animation:fade-in .75s;border-radius:var(--langchat-chat-widget-border-radius);margin-bottom:.5rem;max-width:85%;padding:.5rem 1rem}#langchat-chat-widget__messages_history p{word-wrap:break-word;margin:0}#langchat-chat-widget__messages_history img{max-width:100%;-o-object-fit:cover;object-fit:cover}#langchat-chat-widget__messages_history code{display:inline-block;max-width:100%;overflow-x:auto;vertical-align:bottom}#langchat-chat-widget__messages_history .langchat-chat-widget__message .langchat-chat-widget__message-timestamp{font-size:.8rem;margin-top:.3rem;opacity:.5}#langchat-chat-widget__messages_history .langchat-chat-widget__message.langchat-chat-widget__message--system{align-self:flex-start;background-color:var(--langchat-chat-widget-system-message-bg-color);border-radius:1.125rem 1.125rem 1.125rem 0}#langchat-chat-widget__messages_history .langchat-chat-widget__message.langchat-chat-widget__message--system p{color:var(--langchat-chat-widget-system-message-text-color)}#langchat-chat-widget__messages_history .langchat-chat-widget__message.langchat-chat-widget__message--user{align-self:flex-end;background-color:var(--langchat-chat-widget-user-message-bg-color);border-radius:1.125rem 1.125rem 0 1.125rem}#langchat-chat-widget__messages_history .langchat-chat-widget__message.langchat-chat-widget__message--user p{color:var(--langchat-chat-widget-user-message-text-color)}#langchat-chat-widget__messages_history .langchat-chat-widget__message.langchat-chat-widget__message--user .langchat-chat-widget__message-timestamp{text-align:right}@keyframes fade-in{0%{opacity:0}to{opacity:1}}#langchat-chat-widget__thinking_bubble{align-items:center;animation:fade-in .75s;background-color:var(--langchat-chat-widget-system-message-bg-color);border-radius:var(--langchat-chat-widget-border-radius);display:flex;justify-content:space-between;margin-bottom:.5rem;padding:1rem;width:80px}#langchat-chat-widget__thinking_bubble .circle{animation:bounce 1.5s infinite;background-color:var(--langchat-chat-widget-system-message-text-color);border-radius:50%;height:12px;opacity:.5;width:12px}#langchat-chat-widget__thinking_bubble .circle:first-child{animation-delay:1s}#langchat-chat-widget__thinking_bubble .circle:nth-child(2){animation-delay:1.1s}#langchat-chat-widget__thinking_bubble .circle:nth-child(3){animation-delay:1.2s}@keyframes bounce{0%{transform:translateY(0)}20%{transform:translateY(-.5rem)}40%{transform:translateY(0)}to{transform:translateY(0)}}#langchat-chat-widget__form{display:flex;gap:.5rem;margin-bottom:0;margin-top:1rem;position:relative;width:100%}#langchat-chat-widget__input{background:none;border:1px solid var(--langchat-chat-widget-border-color);border-radius:23px;color:inherit;flex-grow:1;font:inherit;padding:.5rem 1rem;resize:none}#langchat-chat-widget__input:focus{box-shadow:none;outline:none}#langchat-chat-widget__submit{align-items:center;background-color:transparent;border:none;border-radius:50%;color:inherit;color:var(--langchat-chat-widget-primary-color);cursor:pointer;display:flex;justify-content:center;line-height:2rem;min-height:2rem;position:relative;transition:var(--langchat-chat-widget-button-transition)}#langchat-chat-widget__submit:hover{transform:scale(1.05);transition-duration:0s}#langchat-chat-widget__submit:active{transform:scale(.95);transition-duration:0s}#langchat-chat-widget__submit[disabled]{background-color:var(--langchat-chat-widget-border-color);cursor:default;opacity:.5}",document.head.insertBefore(e,document.head.firstChild),Promise.resolve(new Promise(function(e){return setTimeout(e,500)})).then(function(){var e;null==(e=document.querySelector("[data-langchat-chat-widget-button]"))||e.addEventListener("click",Rt),xt.openOnLoad&&Rt({target:document.querySelector("[data-langchat-chat-widget-button]")})})}catch(e){return Promise.reject(e)}},mt="langchat-chat-widget__backdrop",wt=new ce.Renderer,bt=wt.link;wt.link=function(e,t,n){return bt.call(wt,e,t,n).replace(/^<a /,'<a target="_blank" rel="nofollow" ')};var xt=e({url:"",apiKey:"",threadId:null,responseIsAStream:!1,user:{},widgetTitle:"LangChat",greetingMessage:null,disableErrorAlert:!1,closeOnOutsideClick:!0,openOnLoad:!1},null==(ct=window.langchatChatWidget)?void 0:ct.config),kt=function(){};window.addEventListener("load",ft);var yt=document.createElement("div");yt.id="langchat-chat-widget__container";var vt=document.createElement("div");vt.id="langchat-chat-widget__messages_history";var _t=document.createElement("div");_t.id=mt;var $t=document.createElement("div");function Rt(e){if(xt.closeOnOutsideClick&&document.body.appendChild(_t),yt.hasChildNodes())Tt();else{document.body.appendChild(yt),yt.innerHTML='<div id="langchat-chat-widget__header"><div id="langchat-chat-widget__title"><svg height="19" id="langchat-chat-widget__title_icon" viewBox="0 0 24 19" width="24"><path d="M9 6C9.55229 6 10 6.44772 10 7V9C10 9.55228 9.55229 10 9 10C8.44771 10 8 9.55228 8 9V7C8 6.44772 8.44771 6 9 6Z"/><path d="M16 7C16 6.44772 15.5523 6 15 6C14.4477 6 14 6.44772 14 7V9C14 9.55228 14.4477 10 15 10C15.5523 10 16 9.55228 16 9V7Z"/><path d="M19.2099 16C19.0086 16 18.815 16.0768 18.6684 16.2147L16.4858 18.269C15.2525 19.4298 13.2248 18.6278 13.1191 16.9374C13.0862 16.4105 12.6493 16 12.1213 16H5C3.34315 16 2 14.6569 2 13V9C2 9.55228 1.55228 10 1 10C0.447715 10 0 9.55228 0 9V6C0 5.44772 0.447715 5 1 5C1.55228 5 2 5.44772 2 6V3C2 1.34315 3.34315 0 5 0H19C20.6569 0 22 1.34315 22 3V6C22 5.44772 22.4477 5 23 5C23.5523 5 24 5.44772 24 6V9C24 9.55228 23.5523 10 23 10C22.4477 10 22 9.55228 22 9V13.2099C22 14.7508 20.7508 16 19.2099 16ZM5 2C4.44772 2 4 2.44772 4 3V13C4 13.5523 4.44772 14 5 14H12.1213C13.7053 14 15.0163 15.2315 15.1152 16.8124L17.2977 14.7583C17.8152 14.2712 18.4992 14 19.2099 14C19.6463 14 20 13.6463 20 13.2099V3C20 2.44772 19.5523 2 19 2H5Z"/></svg></div><div><a href="https://github.com/tycoding/langchat" id="langchat-chat-widget__branding" target="_blank">Powered by&nbsp;<span>LangChat</span></a></div></div><div id="langchat-chat-widget__body"><form id="langchat-chat-widget__form"><input aria-label="Message" autocomplete="off" id="langchat-chat-widget__input" name="message" placeholder="Ask me a question…" required type="text"><button id="langchat-chat-widget__submit" type="submit"><svg height="26" viewBox="0 0 26 26" width="26" xmlns="http://www.w3.org/2000/svg"><g fill="none"><path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"></path><path d="m21.433 4.861l-6 15.5a1 1 0 0 1-1.624.362l-3.382-3.235l-2.074 2.073a.5.5 0 0 1-.853-.354v-4.519L2.309 9.723a1 1 0 0 1 .442-1.691l17.5-4.5a1 1 0 0 1 1.181 1.329ZM19 6.001L8.032 13.152l1.735 1.66L19 6Z" fill="currentColor"></path></g></svg></button></form></div>',yt.style.display="block";var t=document.createElement("span");t.id="langchat-chat-widget__title_text",t.textContent=xt.widgetTitle,document.getElementById("langchat-chat-widget__title").appendChild(t),document.getElementById("langchat-chat-widget__body").prepend(vt),xt.greetingMessage&&0===vt.children.length&&pt(xt.greetingMessage,Date.now(),"system");var n=(null==e?void 0:e.target)||document.body;kt=function(e,t,n,r){void 0===r&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:a="function"==typeof IntersectionObserver,animationFrame:l=!1}=r,c=Ye(e),h=i||s?[...c?Qe(c):[],...Qe(t)]:[];h.forEach(e=>{i&&e.addEventListener("scroll",n,{passive:!0}),s&&e.addEventListener("resize",n)});const u=c&&a?function(e,t){let n,r=null;const i=Le(e);function s(){var e;clearTimeout(n),null==(e=r)||e.disconnect(),r=null}return function o(a,l){void 0===a&&(a=!1),void 0===l&&(l=1),s();const{left:c,top:h,width:u,height:g}=e.getBoundingClientRect();if(a||t(),!u||!g)return;const d={rootMargin:-de(h)+"px "+-de(i.clientWidth-(c+u))+"px "+-de(i.clientHeight-(h+g))+"px "+-de(c)+"px",threshold:ue(0,he(1,l))||1};let p=!0;function f(e){const t=e[0].intersectionRatio;if(t!==l){if(!p)return o();t?o(!1,t):n=setTimeout(()=>{o(!1,1e-7)},100)}p=!1}try{r=new IntersectionObserver(f,{...d,root:i.ownerDocument})}catch(e){r=new IntersectionObserver(f,d)}r.observe(e)}(!0),s}(c,n):null;let g,d=-1,p=null;o&&(p=new ResizeObserver(e=>{let[r]=e;r&&r.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var e;null==(e=p)||e.observe(t)})),n()}),c&&!l&&p.observe(c),p.observe(t));let f=l?Je(e):null;return l&&function t(){const r=Je(e);!f||r.x===f.x&&r.y===f.y&&r.width===f.width&&r.height===f.height||n(),f=r,g=requestAnimationFrame(t)}(),n(),()=>{var e;h.forEach(e=>{i&&e.removeEventListener("scroll",n),s&&e.removeEventListener("resize",n)}),null==u||u(),null==(e=p)||e.disconnect(),p=null,l&&cancelAnimationFrame(g)}}(n,yt,function(){var e;((e,t,n)=>{const r=new Map,i={platform:at,...n},s={...i.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(null==o.isRTL?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:i}),{x:h,y:u}=Ce(c,r,l),g=r,d={},p=0;for(let n=0;n<a.length;n++){const{name:s,fn:f}=a[n],{x:m,y:w,data:b,reset:x}=await f({x:h,y:u,initialPlacement:r,placement:g,strategy:i,middlewareData:d,rects:c,platform:o,elements:{reference:e,floating:t}});h=null!=m?m:h,u=null!=w?w:u,d={...d,[s]:{...d[s],...b}},x&&p<=50&&(p++,"object"==typeof x&&(x.placement&&(g=x.placement),x.rects&&(c=!0===x.rects?await o.getElementRects({reference:e,floating:t,strategy:i}):x.rects),({x:h,y:u}=Ce(c,g,l))),n=-1)}return{x:h,y:u,placement:g,strategy:i,middlewareData:d}})(e,t,{...i,platform:s})})(n,yt,{placement:"top-start",middleware:[lt(),(e={crossAxis:!0,padding:8},void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=be(e,t),c={x:n,y:r},h=await Ae(t,l),u=_e(xe(i)),g=ye(u);let d=c[g],p=c[u];s&&(d=we(d+h["y"===g?"top":"left"],d,d-h["y"===g?"bottom":"right"])),o&&(p=we(p+h["y"===u?"top":"left"],p,p-h["y"===u?"bottom":"right"]));const f=a.fn({...t,[g]:d,[u]:p});return{...f,data:{x:f.x-n,y:f.y-r}}}})],strategy:"fixed"}).then(function(e){Object.assign(yt.style,{left:e.x+"px",top:e.y-10+"px"})})}),xt.closeOnOutsideClick&&document.getElementById(mt).addEventListener("click",Tt),document.getElementById("langchat-chat-widget__form").addEventListener("submit",ut)}}function Tt(){yt.innerHTML="",yt.remove(),_t.remove(),kt(),kt=function(){}}$t.id="langchat-chat-widget__thinking_bubble",$t.innerHTML='\n    <span class="circle"></span>\n    <span class="circle"></span>\n    <span class="circle"></span>\n  ';var zt=function(e){try{return Promise.resolve(function(){if(e.ok)return Promise.resolve(e.json()).then(function(t){var n=t.message,r=t.threadId;return"string"!=typeof r?(console.error("LangChat Chat Widget: Server error",e),void(xt.disableErrorAlert||alert("Received an OK response but \"threadId\" was of incompatible type (expected 'string', received '"+typeof r+"'). Please make sure the API response is configured correctly.\n\nYou can learn more here: https://github.com/rowyio/langchat-chat-widget?tab=readme-ov-file#connecting-the-widget-to-your-langchat-workflow"))):"string"!=typeof n?(console.error("LangChat Chat Widget: Server error",e),void(xt.disableErrorAlert||alert("Received an OK response but \"message\" was of incompatible type (expected 'string', received '"+typeof n+"'). Please make sure the API response is configured correctly.\n\nYou can learn more here: https://github.com/rowyio/langchat-chat-widget?tab=readme-ov-file#connecting-the-widget-to-your-langchat-workflow"))):n||""===n?Promise.resolve(pt(n,Date.now(),"system")).then(function(){var e,t;xt.threadId=null!=(e=null!=(t=xt.threadId)?t:r)?e:null}):(console.error("LangChat Chat Widget: Server error",e),void(xt.disableErrorAlert||alert("Received an OK response but no message was found. Please make sure the API response is configured correctly. You can learn more here:\n\nhttps://github.com/rowyio/langchat-chat-widget?tab=readme-ov-file#connecting-the-widget-to-your-langchat-workflow")))});console.error("LangChat Chat Widget: Server error",e),xt.disableErrorAlert||alert("Could not send message: "+e.statusText)}())}catch(e){return Promise.reject(e)}},Ct=function(e){try{var n,r,i=function(e){var t,r;if(n)return e;xt.threadId=null!=(t=null!=(r=xt.threadId)?r:s)?t:""!==a?a:null};if(!e.body)return console.error("LangChat Chat Widget: Streamed response has no body",e),xt.disableErrorAlert||alert("Received a streamed response but no body was found. Please make sure the API response is configured correctly."),Promise.resolve();var s=e.headers.get("x-thread-id"),o="",a="",l=Date.now(),c=e.body.getReader(),h=function(e,t,n){for(var r;;){var i=e();if(dt(i)&&(i=i.v),!i)return s;if(i.then){r=0;break}var s=n();if(s&&s.then){if(!dt(s)){r=1;break}s=s.s}if(t){var o=t();if(o&&o.then&&!dt(o)){r=2;break}}}var a=new gt,l=ht.bind(null,a,2);return(0===r?i.then(h):1===r?s.then(c):o.then(u)).then(void 0,l),a;function c(r){s=r;do{if(t&&(o=t())&&o.then&&!dt(o))return void o.then(u).then(void 0,l);if(!(i=e())||dt(i)&&!i.v)return void ht(a,1,s);if(i.then)return void i.then(h).then(void 0,l);dt(s=n())&&(s=s.v)}while(!s||!s.then);s.then(c).then(void 0,l)}function h(e){e?(s=n())&&s.then?s.then(c).then(void 0,l):c(s):ht(a,1,s)}function u(){(i=e())?i.then?i.then(h).then(void 0,l):h(i):ht(a,1,s)}}(function(){return!(r||n)},void 0,function(){return Promise.resolve(c.read()).then(function(e){var i=e.value;if(!e.done&&void 0!==i){for(var s,a=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}((new TextDecoder).decode(i,{stream:!0}).split("\n"));!(s=a()).done;){var c=s.value;if(c.startsWith("data:{")||c.startsWith("{")){var h="";c.startsWith("data:{")&&(h=c.slice(5).trim()),c.startsWith("{")&&(h=c.trim());try{var u=JSON.parse(h).choices[0];if("STOP"===u.finishReason)return void(n=1);o+=u.delta.content}catch(e){console.error("Failed to parse JSON:",e)}}}return Promise.resolve(function(e,t,n){try{var r=vt.querySelector("#langchat-chat-widget__message--"+n+"--"+t);return Promise.resolve(function(){if(r){var i=r.querySelector("p");return Promise.resolve(ce(e,{renderer:wt})).then(function(e){i.innerHTML=e})}return Promise.resolve(pt(e,t,n)).then(function(){})}())}catch(e){return Promise.reject(e)}}(o,l,"system")).then(function(){})}r=1})});return Promise.resolve(h&&h.then?h.then(i):i(h))}catch(e){return Promise.reject(e)}},At={open:Rt,close:Tt,config:xt,init:ft};window.langchatChatWidget=At,module.exports=At;
//# sourceMappingURL=index.cjs.map
